<div class="create-credit-request-container">
  <h2>Create Credit Request</h2>

  <div class="loading" *ngIf="loading$ | async">
    <div class="spinner"></div>
    <p>Creating credit request...</p>
  </div>

  <div class="error" *ngIf="error$ | async as error">
    <p class="error-message">
      {{
        error.message || "An error occurred while creating the credit request."
      }}
    </p>
  </div>

  <form
    [formGroup]="creditRequestForm"
    (ngSubmit)="onSubmit()"
    *ngIf="!(loading$ | async)"
  >
    <div class="form-group">
      <label for="amount">Amount</label>
      <div class="input-group">
        <span class="input-group-text">$</span>
        <input
          type="number"
          id="amount"
          formControlName="amount"
          class="form-control"
          placeholder="Enter amount"
          [ngClass]="{
            'is-invalid':
              creditRequestForm.get('amount')?.invalid &&
              creditRequestForm.get('amount')?.touched
          }"
        />
      </div>
      <div
        class="invalid-feedback"
        *ngIf="
          creditRequestForm.get('amount')?.invalid &&
          creditRequestForm.get('amount')?.touched
        "
      >
        {{ getErrorMessage("amount") }}
      </div>
    </div>

    <div class="form-group">
      <label for="purpose">Purpose</label>
      <textarea
        id="purpose"
        formControlName="purpose"
        class="form-control"
        rows="4"
        placeholder="Enter the purpose of your credit request"
        [ngClass]="{
          'is-invalid':
            creditRequestForm.get('purpose')?.invalid &&
            creditRequestForm.get('purpose')?.touched
        }"
      ></textarea>
      <div
        class="invalid-feedback"
        *ngIf="
          creditRequestForm.get('purpose')?.invalid &&
          creditRequestForm.get('purpose')?.touched
        "
      >
        {{ getErrorMessage("purpose") }}
      </div>
    </div>

    <div class="form-actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="creditRequestForm.invalid || (loading$ | async)"
      >
        Submit Request
      </button>
    </div>
  </form>
</div>
